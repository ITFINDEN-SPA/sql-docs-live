---
title: "O2SS0339: Cannot convert usage of standalone user-defined type (Error)"
description: "Covers the reasons why SQL Server Migration Assistant (SSMA) for Oracle cannot convert standalone user-defined types."
author: cpichuka
ms.author: cpichuka
ms.reviewer: randolphwest
ms.date: 05/08/2024
ms.service: sql
ms.subservice: ssma
ms.topic: reference
ms.custom:
  - sql-migration-content
ms.devlang: sql
---

# O2SS0339: Cannot convert usage of standalone user-defined type (Error)

This article covers the reasons why SQL Server Migration Assistant (SSMA) for Oracle can't convert standalone user-defined types.

## Background

A user-defined data type (UDT) is an entitled data type that is made in the database by the user. A UDT can be a distinct type which segments a common representation with a built-in data type.

Whenever you create a user-defined data type and make a reference of that data type in a packaged query to declare a variable, SSMA doesn't recognize this data type and hence doesn't convert it to corresponding [!INCLUDE [ssnoversion-md](../../../includes/ssnoversion-md.md)] code. This is because the user-defined data type isn't defined in the scope of the code where the variable is being declared and hence generates an error message.

## Example

In the following example, you create two different UDTs and then create a package specification followed by a package body. These UDTs are used to declare variables in the package code.

```sql
CREATE OR REPLACE TYPE TO_TEXT AS OBJECT
(
    Text_Id NUMBER,
    Line NUMBER,
    Text VARCHAR2(2000)
)
/

CREATE OR REPLACE TYPE TT_TEXT AS TABLE OF To_Text
/

CREATE OR REPLACE PACKAGE PKG_UDTVAR_TEST IS
    g_Text Tt_Text;
END PKG_UDTVAR_TEST;
/

CREATE OR REPLACE PACKAGE BODY PKG_UDTVAR_TEST IS
BEGIN
    g_Text := Tt_Text();
END PKG_UDTVAR_TEST;
```

When you try to convert the previous code in SSMA, it generates the following error message:

> O2SS0339: Cannot convert usage of standalone user-defined type

## Possible remedies

The solution to the previous error is to rewrite the code in Oracle. Just create the user-defined data types inside the package specification keeping the remaining code as is.

When you define the UDTs inside the package specification, the UDTs come in the scope of the package and hence the error is resolved.

```sql
CREATE OR REPLACE PACKAGE PKG_UDTVAR_TEST IS
    TYPE TO_TEXT IS RECORD
    (
        Text_Id NUMBER,
        Line NUMBER,
        Text VARCHAR2(2000)
    );

    TYPE TT_TEXT IS TABLE OF TO_TEXT;
    g_Text Tt_Text;
END PKG_UDTVAR_TEST;
/

CREATE OR REPLACE PACKAGE BODY PKG_UDTVAR_TEST IS
BEGIN
    g_Text:=Tt_Text();
END PKG_UDTVAR_TEST;
```

Here's the corresponding [!INCLUDE [ssnoversion-md](../../../includes/ssnoversion-md.md)] code generated by SSMA:

```sql
CREATE PROCEDURE dbo.PKG_UDTVAR_TEST$SSMA_Initialize_Package
AS
BEGIN
    DECLARE
        @CollectionIndexInt$TYPE varchar(max) = ' TABLE OF ( RECORD ( TEXT_ID DOUBLE , LINE DOUBLE , TEXT STRING ) )'

    EXECUTE ssma_oracle.db_clean_storage

    DECLARE
        @g_Text dbo.CollectionIndexInt

    EXECUTE ssma_oracle.set_pv_collection_int
        DB_NAME(),
        'DBO',
        'PKG_UDTVAR_TEST',
        'G_TEXT',
        @g_Text

    DECLARE
        @temp dbo.CollectionIndexInt

    SET @temp = dbo.CollectionIndexInt::[Null].SetType(@CollectionIndexInt$TYPE)

    EXECUTE ssma_oracle.set_pv_collection_int
        DB_NAME(),
        'DBO',
        'PKG_UDTVAR_TEST',
        'G_TEXT',
        @temp
END
```

For more information about how SSMA converts records and collections, see [Emulating Records and Collections via CLR UDT](../emulate-records-collections-via-clr.md).
